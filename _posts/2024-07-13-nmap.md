---
title: "Nmap - ç½‘ç»œå‘ç°ä¸å®‰å…¨æ‰«æå®Œå…¨æŒ‡å—"
author: Kk
date: 2024-07-13
category: DevOps
layout: post
tags: [nmap, network, security, scanning, penetration-testing]
excerpt: "Nmapæ˜¯ç½‘ç»œå®‰å…¨é¢†åŸŸæœ€å¼ºå¤§çš„æ‰«æå·¥å…·ä¹‹ä¸€ï¼Œæœ¬æ–‡è¯¦ç»†ä»‹ç»å…¶å„ç§æ‰«ææŠ€æœ¯ã€è„šæœ¬å¼•æ“å’Œå®é™…åº”ç”¨åœºæ™¯ã€‚"
---

# Nmap - ç½‘ç»œå‘ç°ä¸å®‰å…¨æ‰«æå®Œå…¨æŒ‡å— ğŸ”

> Nmapï¼ˆNetwork Mapperï¼‰æ˜¯ä¸€ä¸ªå¼€æºçš„ç½‘ç»œå‘ç°å’Œå®‰å…¨å®¡è®¡å·¥å…·ï¼Œè¢«å¹¿æ³›ç”¨äºç½‘ç»œåº“å­˜ã€ç®¡ç†æœåŠ¡å‡çº§è®¡åˆ’ä»¥åŠç›‘æ§ä¸»æœºæˆ–æœåŠ¡è¿è¡ŒçŠ¶å†µã€‚

## ğŸ“Š ç›®å½•

- [åŸºç¡€æ‰«ææŠ€æœ¯](#åŸºç¡€æ‰«ææŠ€æœ¯)
- [é«˜çº§æ‰«æé€‰é¡¹](#é«˜çº§æ‰«æé€‰é¡¹)
- [è„šæœ¬å¼•æ“ä½¿ç”¨](#è„šæœ¬å¼•æ“ä½¿ç”¨)
- [è¾“å‡ºæ ¼å¼è¯¦è§£](#è¾“å‡ºæ ¼å¼è¯¦è§£)
- [å®é™…åº”ç”¨åœºæ™¯](#å®é™…åº”ç”¨åœºæ™¯)
- [é˜²ç«å¢™è§„é¿æŠ€æœ¯](#é˜²ç«å¢™è§„é¿æŠ€æœ¯)
- [æ€§èƒ½ä¼˜åŒ–](#æ€§èƒ½ä¼˜åŒ–)
- [å®‰å…¨ä¸åˆè§„](#å®‰å…¨ä¸åˆè§„)

---

## ğŸš€ åŸºç¡€æ‰«ææŠ€æœ¯

### ä¸»æœºå‘ç°æ‰«æ
```bash
# åŸºæœ¬ä¸»æœºå‘ç°ï¼ˆPingæ‰«æï¼‰
nmap -sn 192.168.1.0/24

# ç¦ç”¨DNSè§£æï¼ŒåŠ å¿«æ‰«æé€Ÿåº¦
nmap -sn -n 192.168.1.0/24

# ä½¿ç”¨ARPæ‰«æï¼ˆå±€åŸŸç½‘å†…æœ€æœ‰æ•ˆï¼‰
nmap -sn -PR 192.168.1.0/24

# TCP SYN Ping
nmap -sn -PS80,443,22 192.168.1.0/24

# ICMP Pingæ‰«æ
nmap -sn -PE 192.168.1.0/24

# UDP Pingæ‰«æ
nmap -sn -PU53,67,68,161 192.168.1.0/24
```

### ç«¯å£æ‰«ææŠ€æœ¯
```bash
# TCP SYNæ‰«æï¼ˆåŠå¼€æ‰«æï¼Œé»˜è®¤æ–¹å¼ï¼‰
nmap -sS 192.168.1.100

# TCPè¿æ¥æ‰«æï¼ˆå®Œæ•´ä¸‰æ¬¡æ¡æ‰‹ï¼‰
nmap -sT 192.168.1.100

# UDPæ‰«æ
nmap -sU 192.168.1.100

# ç»¼åˆTCPå’ŒUDPæ‰«æ
nmap -sS -sU 192.168.1.100

# FINæ‰«æï¼ˆéšè”½æ‰«æï¼‰
nmap -sF 192.168.1.100

# NULLæ‰«æ
nmap -sN 192.168.1.100

# Xmasæ‰«æ
nmap -sX 192.168.1.100

# ACKæ‰«æï¼ˆæ£€æµ‹é˜²ç«å¢™è§„åˆ™ï¼‰
nmap -sA 192.168.1.100
```

### ç«¯å£æŒ‡å®šä¸èŒƒå›´
```bash
# æ‰«æç‰¹å®šç«¯å£
nmap -p 80,443,22 192.168.1.100

# æ‰«æç«¯å£èŒƒå›´
nmap -p 1-1000 192.168.1.100

# æ‰«ææ‰€æœ‰65535ä¸ªç«¯å£
nmap -p- 192.168.1.100

# æ‰«ææœ€å¸¸è§çš„ç«¯å£
nmap --top-ports 100 192.168.1.100

# å¿«é€Ÿæ‰«æï¼ˆå¸¸è§çš„1000ä¸ªç«¯å£ï¼‰
nmap -F 192.168.1.100

# æ‰«ææŒ‡å®šåè®®çš„ç«¯å£
nmap -p U:53,111,137,T:21-25,80,139,8080 192.168.1.100
```

---

## ğŸ”§ é«˜çº§æ‰«æé€‰é¡¹

### æœåŠ¡å’Œç‰ˆæœ¬æ£€æµ‹
```bash
# æœåŠ¡ç‰ˆæœ¬æ£€æµ‹
nmap -sV 192.168.1.100

# æ“ä½œç³»ç»Ÿæ£€æµ‹
nmap -O 192.168.1.100

# æ¿€è¿›æ¨¡å¼ï¼ˆåŒ…å«OSæ£€æµ‹ã€ç‰ˆæœ¬æ£€æµ‹ã€è„šæœ¬æ‰«æå’Œè·¯ç”±è·Ÿè¸ªï¼‰
nmap -A 192.168.1.100

# è®¾ç½®ç‰ˆæœ¬æ£€æµ‹å¼ºåº¦ï¼ˆ0-9ï¼Œé»˜è®¤7ï¼‰
nmap -sV --version-intensity 9 192.168.1.100

# è½»é‡çº§ç‰ˆæœ¬æ£€æµ‹
nmap -sV --version-light 192.168.1.100

# å…¨é¢ç‰ˆæœ¬æ£€æµ‹
nmap -sV --version-all 192.168.1.100
```

### æ—¶é—´å’Œæ€§èƒ½è°ƒä¼˜
```bash
# è®¾ç½®æ‰«æé€Ÿåº¦ï¼ˆ0-5ï¼Œ5æœ€å¿«ï¼‰
nmap -T4 192.168.1.100

# è‡ªå®šä¹‰è¶…æ—¶è®¾ç½®
nmap --host-timeout 300s 192.168.1.100

# è®¾ç½®æœ€å¤§å¹¶è¡Œæ‰«ææ•°
nmap --max-parallelism 100 192.168.1.100

# è®¾ç½®æ‰«æå»¶è¿Ÿ
nmap --scan-delay 1s 192.168.1.100

# éšæœºåŒ–ä¸»æœºæ‰«æé¡ºåº
nmap --randomize-hosts 192.168.1.0/24
```

### è¾“å‡ºè¯¦ç»†ç¨‹åº¦
```bash
# è¯¦ç»†è¾“å‡º
nmap -v 192.168.1.100

# æ›´è¯¦ç»†è¾“å‡º
nmap -vv 192.168.1.100

# è°ƒè¯•æ¨¡å¼
nmap -d 192.168.1.100

# åŸå› è§£é‡Šï¼ˆæ˜¾ç¤ºç«¯å£çŠ¶æ€çš„åŸå› ï¼‰
nmap --reason 192.168.1.100

# æ˜¾ç¤ºä¸»æœºå’Œç«¯å£çš„æ‰€æœ‰ä¿¡æ¯
nmap --packet-trace 192.168.1.100
```

---

## ğŸ“œ è„šæœ¬å¼•æ“ä½¿ç”¨

### è„šæœ¬åˆ†ç±»æ‰«æ
```bash
# è¿è¡Œé»˜è®¤è„šæœ¬
nmap -sC 192.168.1.100

# è¿è¡Œç‰¹å®šç±»åˆ«çš„è„šæœ¬
nmap --script vuln 192.168.1.100
nmap --script auth 192.168.1.100
nmap --script brute 192.168.1.100
nmap --script discovery 192.168.1.100
nmap --script dos 192.168.1.100
nmap --script exploit 192.168.1.100
nmap --script external 192.168.1.100
nmap --script fuzzer 192.168.1.100
nmap --script intrusive 192.168.1.100
nmap --script malware 192.168.1.100
nmap --script safe 192.168.1.100
nmap --script version 192.168.1.100
```

### ç‰¹å®šæœåŠ¡è„šæœ¬
```bash
# HTTPæœåŠ¡è„šæœ¬
nmap -p 80 --script http-enum 192.168.1.100
nmap -p 80 --script http-headers 192.168.1.100
nmap -p 80 --script http-methods 192.168.1.100
nmap -p 80 --script http-robots.txt 192.168.1.100
nmap -p 80 --script http-title 192.168.1.100

# SSHæœåŠ¡è„šæœ¬
nmap -p 22 --script ssh-auth-methods 192.168.1.100
nmap -p 22 --script ssh-hostkey 192.168.1.100
nmap -p 22 --script ssh-brute 192.168.1.100

# SMBæœåŠ¡è„šæœ¬
nmap -p 445 --script smb-enum-shares 192.168.1.100
nmap -p 445 --script smb-os-discovery 192.168.1.100
nmap -p 445 --script smb-security-mode 192.168.1.100
nmap -p 445 --script smb-vuln-* 192.168.1.100

# FTPæœåŠ¡è„šæœ¬
nmap -p 21 --script ftp-anon 192.168.1.100
nmap -p 21 --script ftp-bounce 192.168.1.100
nmap -p 21 --script ftp-brute 192.168.1.100

# DNSæœåŠ¡è„šæœ¬
nmap -p 53 --script dns-zone-transfer 192.168.1.100
nmap --script broadcast-dns-service-discovery
```

### æ¼æ´æ‰«æè„šæœ¬
```bash
# å¸¸è§æ¼æ´æ‰«æ
nmap --script vuln 192.168.1.100

# ç‰¹å®šCVEæ¼æ´æ£€æµ‹
nmap --script smb-vuln-ms17-010 192.168.1.100
nmap --script http-vuln-cve2017-5638 192.168.1.100
nmap --script ssl-heartbleed 192.168.1.100

# Webåº”ç”¨æ¼æ´
nmap -p 80,443 --script http-sql-injection 192.168.1.100
nmap -p 80,443 --script http-xssed 192.168.1.100
nmap -p 80,443 --script http-shellshock 192.168.1.100

# SSL/TLSå®‰å…¨æ£€æµ‹
nmap -p 443 --script ssl-enum-ciphers 192.168.1.100
nmap -p 443 --script ssl-cert 192.168.1.100
nmap -p 443 --script ssl-date 192.168.1.100
```

---

## ğŸ“„ è¾“å‡ºæ ¼å¼è¯¦è§£

### å¤šç§è¾“å‡ºæ ¼å¼
```bash
# æ­£å¸¸è¾“å‡º
nmap -oN scan_results.txt 192.168.1.100

# XMLè¾“å‡º
nmap -oX scan_results.xml 192.168.1.100

# Grepableè¾“å‡º
nmap -oG scan_results.grep 192.168.1.100

# æ‰€æœ‰æ ¼å¼è¾“å‡º
nmap -oA scan_results 192.168.1.100

# æ ‡å‡†è¾“å‡ºåŒæ—¶ä¿å­˜åˆ°æ–‡ä»¶
nmap 192.168.1.100 | tee scan_results.txt
```

### è¾“å‡ºæ§åˆ¶
```bash
# ä¸æ˜¾ç¤ºè¿è¡Œæ—¶ä¿¡æ¯
nmap --stats-every 0 192.168.1.100

# ç¦ç”¨DNSè§£æï¼ˆåŠ å¿«æ‰«æé€Ÿåº¦ï¼‰
nmap -n 192.168.1.100

# æ˜¾ç¤ºå…³é—­çš„ç«¯å£
nmap --open 192.168.1.100

# åªæ˜¾ç¤ºå¼€æ”¾ç«¯å£
nmap --open 192.168.1.0/24

# è¿½åŠ åˆ°ç°æœ‰æ–‡ä»¶
nmap --append-output -oN existing_scan.txt 192.168.1.100
```

---

## ğŸ¯ å®é™…åº”ç”¨åœºæ™¯

### ç½‘ç»œèµ„äº§å‘ç°
```bash
#!/bin/bash
# network_discovery.sh - ç½‘ç»œèµ„äº§å‘ç°è„šæœ¬

NETWORK="192.168.1.0/24"
OUTPUT_DIR="./network_scan_$(date +%Y%m%d_%H%M%S)"

mkdir -p "$OUTPUT_DIR"

echo "å¼€å§‹ç½‘ç»œèµ„äº§å‘ç°..."

# 1. ä¸»æœºå‘ç°
echo "1. ä¸»æœºå‘ç°ä¸­..."
nmap -sn -PE -PP -PM -PO "$NETWORK" -oA "$OUTPUT_DIR/host_discovery"

# æå–æ´»è·ƒä¸»æœº
grep "Up" "$OUTPUT_DIR/host_discovery.nmap" | awk '{print $2}' > "$OUTPUT_DIR/live_hosts.txt"

# 2. ç«¯å£æ‰«æ
echo "2. ç«¯å£æ‰«æä¸­..."
nmap -sS -T4 --top-ports 1000 -iL "$OUTPUT_DIR/live_hosts.txt" -oA "$OUTPUT_DIR/port_scan"

# 3. æœåŠ¡è¯†åˆ«
echo "3. æœåŠ¡è¯†åˆ«ä¸­..."
nmap -sV -sC -T4 -iL "$OUTPUT_DIR/live_hosts.txt" -oA "$OUTPUT_DIR/service_scan"

# 4. æ“ä½œç³»ç»Ÿè¯†åˆ«
echo "4. æ“ä½œç³»ç»Ÿè¯†åˆ«ä¸­..."
nmap -O -T4 -iL "$OUTPUT_DIR/live_hosts.txt" -oA "$OUTPUT_DIR/os_scan" 2>/dev/null

echo "æ‰«æå®Œæˆï¼Œç»“æœä¿å­˜åœ¨ $OUTPUT_DIR ç›®å½•ä¸­"
```

### æ¼æ´è¯„ä¼°
```bash
#!/bin/bash
# vulnerability_assessment.sh - æ¼æ´è¯„ä¼°è„šæœ¬

TARGET="$1"
OUTPUT_DIR="./vuln_scan_$(date +%Y%m%d_%H%M%S)"

if [ -z "$TARGET" ]; then
    echo "ä½¿ç”¨æ–¹æ³•: $0 <target_ip_or_range>"
    exit 1
fi

mkdir -p "$OUTPUT_DIR"

echo "å¼€å§‹æ¼æ´è¯„ä¼°: $TARGET"

# 1. åŸºç¡€æ‰«æ
echo "1. åŸºç¡€æ‰«æ..."
nmap -sS -sV -T4 "$TARGET" -oA "$OUTPUT_DIR/basic_scan"

# 2. æ¼æ´æ‰«æ
echo "2. æ¼æ´æ‰«æ..."
nmap --script vuln -T4 "$TARGET" -oA "$OUTPUT_DIR/vuln_scan"

# 3. å¸¸è§æœåŠ¡æ¼æ´æ£€æµ‹
echo "3. å¸¸è§æœåŠ¡æ¼æ´æ£€æµ‹..."

# SMBæ¼æ´
nmap -p 445 --script smb-vuln-* "$TARGET" -oN "$OUTPUT_DIR/smb_vulns.txt"

# WebæœåŠ¡æ¼æ´
nmap -p 80,443,8080,8443 --script http-vuln-* "$TARGET" -oN "$OUTPUT_DIR/web_vulns.txt"

# SSL/TLSæ¼æ´
nmap -p 443,993,995 --script ssl-* "$TARGET" -oN "$OUTPUT_DIR/ssl_vulns.txt"

# 4. å¼±å¯†ç æ£€æµ‹
echo "4. å¼±å¯†ç æ£€æµ‹..."
nmap --script brute "$TARGET" -oN "$OUTPUT_DIR/brute_force.txt"

echo "æ¼æ´è¯„ä¼°å®Œæˆï¼Œç»“æœä¿å­˜åœ¨ $OUTPUT_DIR ç›®å½•ä¸­"

# ç”ŸæˆæŠ¥å‘Šæ‘˜è¦
echo "ç”ŸæˆæŠ¥å‘Šæ‘˜è¦..."
{
    echo "=== æ¼æ´è¯„ä¼°æŠ¥å‘Š ==="
    echo "ç›®æ ‡: $TARGET"
    echo "æ—¶é—´: $(date)"
    echo ""
    echo "=== å‘ç°çš„æ¼æ´ ==="
    grep -i "vulnerable\|exploit\|CVE" "$OUTPUT_DIR"/*.txt | head -20
} > "$OUTPUT_DIR/summary.txt"
```

### Webåº”ç”¨æ‰«æ
```bash
#!/bin/bash
# web_app_scan.sh - Webåº”ç”¨å®‰å…¨æ‰«æ

TARGET="$1"
PORT="${2:-80}"

if [ -z "$TARGET" ]; then
    echo "ä½¿ç”¨æ–¹æ³•: $0 <target> [port]"
    exit 1
fi

echo "æ‰«æWebåº”ç”¨: $TARGET:$PORT"

# HTTPæ–¹æ³•æ£€æµ‹
echo "æ£€æµ‹HTTPæ–¹æ³•..."
nmap -p "$PORT" --script http-methods "$TARGET"

# ç›®å½•æšä¸¾
echo "ç›®å½•æšä¸¾..."
nmap -p "$PORT" --script http-enum "$TARGET"

# å¸¸è§æ¼æ´æ£€æµ‹
echo "æ¼æ´æ£€æµ‹..."
nmap -p "$PORT" --script http-vuln-* "$TARGET"

# SQLæ³¨å…¥æ£€æµ‹
echo "SQLæ³¨å…¥æ£€æµ‹..."
nmap -p "$PORT" --script http-sql-injection "$TARGET"

# XSSæ£€æµ‹
echo "XSSæ£€æµ‹..."
nmap -p "$PORT" --script http-xssed "$TARGET"

# å¤‡ä»½æ–‡ä»¶æ£€æµ‹
echo "å¤‡ä»½æ–‡ä»¶æ£€æµ‹..."
nmap -p "$PORT" --script http-backup-finder "$TARGET"

# æ•æ„Ÿä¿¡æ¯æ³„éœ²
echo "æ•æ„Ÿä¿¡æ¯æ£€æµ‹..."
nmap -p "$PORT" --script http-config-backup,http-frontpage-login "$TARGET"
```

---

## ğŸ›¡ï¸ é˜²ç«å¢™è§„é¿æŠ€æœ¯

### åŸºæœ¬è§„é¿æŠ€æœ¯
```bash
# åˆ†ç‰‡æ‰«æ
nmap -f 192.168.1.100

# MTUè®¾ç½®
nmap --mtu 24 192.168.1.100

# ä½¿ç”¨è¯±é¥µIP
nmap -D RND:10 192.168.1.100
nmap -D 192.168.1.10,192.168.1.11,ME 192.168.1.100

# æºç«¯å£æ¬ºéª—
nmap --source-port 53 192.168.1.100
nmap -g 53 192.168.1.100

# ç©ºé—²æ‰«æ
nmap -sI zombie_host target_host

# FTPåå¼¹æ‰«æ
nmap -b ftp_relay_host target_host
```

### æ—¶é—´è§„é¿
```bash
# æ…¢é€Ÿæ‰«æ
nmap -T0 192.168.1.100

# æ·»åŠ éšæœºå»¶è¿Ÿ
nmap --scan-delay 10s 192.168.1.100

# éšæœºåŒ–æ‰«æé¡ºåº
nmap --randomize-hosts 192.168.1.0/24

# é™åˆ¶å‘åŒ…ç‡
nmap --max-rate 10 192.168.1.100
```

### é«˜çº§è§„é¿æŠ€æœ¯
```bash
# ä½¿ç”¨åŸå§‹IPåŒ…
nmap --send-eth 192.168.1.100

# è‡ªå®šä¹‰IPé€‰é¡¹
nmap --ip-options "L 192.168.1.1 192.168.1.2" 192.168.1.100

# åæ ¡éªŒå’Œ
nmap --badsum 192.168.1.100

# æ•°æ®å¡«å……
nmap --data-length 25 192.168.1.100

# MACåœ°å€æ¬ºéª—
nmap --spoof-mac Dell 192.168.1.100
nmap --spoof-mac 0 192.168.1.100
```

---

## âš¡ æ€§èƒ½ä¼˜åŒ–

### å¹¶è¡ŒåŒ–å’Œé€Ÿåº¦æ§åˆ¶
```bash
# è®¾ç½®å¹¶è¡Œä¸»æœºæ•°
nmap --min-hostgroup 50 --max-hostgroup 100 192.168.1.0/24

# è®¾ç½®å¹¶è¡Œæ¢æµ‹æ•°
nmap --min-parallelism 10 --max-parallelism 300 192.168.1.100

# è®¾ç½®é‡ä¼ æ¬¡æ•°
nmap --max-retries 2 192.168.1.100

# RTTè¶…æ—¶è®¾ç½®
nmap --min-rtt-timeout 100ms --max-rtt-timeout 2s 192.168.1.100

# å‘åŒ…é€Ÿç‡æ§åˆ¶
nmap --min-rate 100 --max-rate 1000 192.168.1.100
```

### ç½‘ç»œä¼˜åŒ–è„šæœ¬
```bash
#!/bin/bash
# optimized_scan.sh - ä¼˜åŒ–çš„ç½‘ç»œæ‰«æ

TARGET="$1"
THREADS="${2:-50}"

if [ -z "$TARGET" ]; then
    echo "ä½¿ç”¨æ–¹æ³•: $0 <target> [threads]"
    exit 1
fi

# å¿«é€Ÿä¸»æœºå‘ç°
echo "å¿«é€Ÿä¸»æœºå‘ç°..."
nmap -sn -T5 --min-hostgroup "$THREADS" "$TARGET" | \
grep "Nmap scan report" | awk '{print $5}' > live_hosts.tmp

HOST_COUNT=$(wc -l < live_hosts.tmp)
echo "å‘ç° $HOST_COUNT ä¸ªæ´»è·ƒä¸»æœº"

if [ "$HOST_COUNT" -eq 0 ]; then
    echo "æœªå‘ç°æ´»è·ƒä¸»æœº"
    rm live_hosts.tmp
    exit 1
fi

# å¿«é€Ÿç«¯å£æ‰«æ
echo "å¿«é€Ÿç«¯å£æ‰«æ..."
nmap -sS -T5 --top-ports 100 \
     --min-hostgroup "$THREADS" \
     --max-retries 1 \
     --host-timeout 5m \
     -iL live_hosts.tmp

# æ¸…ç†ä¸´æ—¶æ–‡ä»¶
rm live_hosts.tmp
```

---

## ğŸ” å®‰å…¨ä¸åˆè§„

### åˆè§„æ‰«æ
```bash
#!/bin/bash
# compliance_scan.sh - åˆè§„æ€§æ‰«æ

TARGET="$1"
POLICY="${2:-pci}"  # pci, hipaa, soc2

if [ -z "$TARGET" ]; then
    echo "ä½¿ç”¨æ–¹æ³•: $0 <target> [policy]"
    exit 1
fi

OUTPUT_DIR="./compliance_scan_$(date +%Y%m%d_%H%M%S)"
mkdir -p "$OUTPUT_DIR"

echo "å¼€å§‹ $POLICY åˆè§„æ€§æ‰«æ: $TARGET"

case "$POLICY" in
    "pci")
        echo "PCI DSS åˆè§„æ€§æ£€æµ‹..."
        # SSL/TLSé…ç½®æ£€æµ‹
        nmap -p 443 --script ssl-enum-ciphers,ssl-cert "$TARGET" -oN "$OUTPUT_DIR/ssl_pci.txt"

        # å¼±åŠ å¯†æ£€æµ‹
        nmap -p 80,443 --script ssl-dh-params "$TARGET" -oN "$OUTPUT_DIR/weak_crypto.txt"
        ;;

    "hipaa")
        echo "HIPAA åˆè§„æ€§æ£€æµ‹..."
        # åŠ å¯†ä¼ è¾“æ£€æµ‹
        nmap --script ssl-cert,ssl-enum-ciphers "$TARGET" -oN "$OUTPUT_DIR/encryption.txt"
        ;;

    "soc2")
        echo "SOC 2 åˆè§„æ€§æ£€æµ‹..."
        # è®¿é—®æ§åˆ¶æ£€æµ‹
        nmap --script auth "$TARGET" -oN "$OUTPUT_DIR/access_control.txt"
        ;;
esac

echo "åˆè§„æ€§æ‰«æå®Œæˆï¼Œç»“æœä¿å­˜åœ¨ $OUTPUT_DIR"
```

### å®‰å…¨æ‰«ææœ€ä½³å®è·µ
```bash
#!/bin/bash
# secure_scan.sh - å®‰å…¨æ‰«ææœ€ä½³å®è·µ

TARGET="$1"
if [ -z "$TARGET" ]; then
    echo "ä½¿ç”¨æ–¹æ³•: $0 <target>"
    exit 1
fi

# æ£€æŸ¥æ‰«ææƒé™
echo "æ£€æŸ¥æ‰«ææˆæƒ..."
read -p "æ‚¨æ˜¯å¦æœ‰æƒé™æ‰«æç›®æ ‡ $TARGET? (y/n): " permission
if [ "$permission" != "y" ]; then
    echo "æœªè·å¾—æ‰«ææˆæƒï¼Œé€€å‡º"
    exit 1
fi

# åˆ›å»ºè¾“å‡ºç›®å½•
OUTPUT_DIR="./authorized_scan_$(date +%Y%m%d_%H%M%S)"
mkdir -p "$OUTPUT_DIR"

# è®°å½•æ‰«ææ—¥å¿—
exec > >(tee -a "$OUTPUT_DIR/scan.log")
exec 2>&1

echo "=== æˆæƒå®‰å…¨æ‰«æå¼€å§‹ ==="
echo "æ“ä½œå‘˜: $(whoami)"
echo "æ—¶é—´: $(date)"
echo "ç›®æ ‡: $TARGET"
echo "=================================="

# 1. è½»é‡çº§åˆå§‹æ‰«æ
echo "1. æ‰§è¡Œåˆå§‹æ‰«æ..."
nmap -sS -T3 --top-ports 100 "$TARGET" -oA "$OUTPUT_DIR/initial"

# 2. æœåŠ¡è¯†åˆ«
echo "2. æœåŠ¡è¯†åˆ«..."
nmap -sV -T3 "$TARGET" -oA "$OUTPUT_DIR/services"

# 3. å®‰å…¨è„šæœ¬æ‰«æï¼ˆéä¾µå…¥æ€§ï¼‰
echo "3. å®‰å…¨æ£€æµ‹ï¼ˆéä¾µå…¥æ€§ï¼‰..."
nmap --script "safe and not intrusive" "$TARGET" -oA "$OUTPUT_DIR/security"

# 4. ç”ŸæˆæŠ¥å‘Š
echo "4. ç”Ÿæˆå®‰å…¨æŠ¥å‘Š..."
{
    echo "=== å®‰å…¨æ‰«ææŠ¥å‘Š ==="
    echo "æ‰«ææ—¶é—´: $(date)"
    echo "ç›®æ ‡: $TARGET"
    echo ""
    echo "=== å¼€æ”¾ç«¯å£ ==="
    grep -E "^[0-9]+" "$OUTPUT_DIR/initial.nmap"
    echo ""
    echo "=== è¯†åˆ«çš„æœåŠ¡ ==="
    grep -E "^[0-9]+" "$OUTPUT_DIR/services.nmap"
    echo ""
    echo "=== å®‰å…¨å‘ç° ==="
    grep -i "vulnerable\|warning\|risk" "$OUTPUT_DIR/security.nmap"
} > "$OUTPUT_DIR/security_report.txt"

echo "æ‰«æå®Œæˆï¼ŒæŠ¥å‘Šä¿å­˜åœ¨: $OUTPUT_DIR/security_report.txt"
```

---

## ğŸ“š å®ç”¨å‘½ä»¤é€ŸæŸ¥

### å¸¸ç”¨æ‰«æç»„åˆ
```bash
# å¿«é€Ÿç½‘ç»œæ¦‚è§ˆ
nmap -sn -T4 192.168.1.0/24

# åŸºæœ¬å®‰å…¨æ‰«æ
nmap -sS -sV -O -T4 --script=default 192.168.1.100

# å…¨é¢æ¼æ´æ‰«æ
nmap -sS -sV -O -T4 --script=vuln 192.168.1.100

# WebæœåŠ¡å™¨æ‰«æ
nmap -p 80,443 -sV --script=http-* 192.168.1.100

# æ•°æ®åº“æœåŠ¡æ‰«æ
nmap -p 1433,1521,3306,5432 -sV --script=*-brute 192.168.1.100

# é‚®ä»¶æœåŠ¡å™¨æ‰«æ
nmap -p 25,110,143,993,995 -sV --script=smtp-*,pop3-*,imap-* 192.168.1.100

# DNSæœåŠ¡å™¨æ‰«æ
nmap -p 53 -sU -sV --script=dns-* 192.168.1.100
```

### è¾“å‡ºå¤„ç†
```bash
# æå–å¼€æ”¾ç«¯å£
grep "open" scan.nmap | awk '{print $1}' | cut -d'/' -f1

# æå–HTTPæœåŠ¡
grep -E "80|443|8080|8443" scan.nmap | grep "open"

# ç»Ÿè®¡æ‰«æç»“æœ
grep "Nmap scan report" scan.nmap | wc -l

# è½¬æ¢XMLåˆ°HTML
xsltproc /usr/share/nmap/nmap.xsl scan.xml -o scan.html

# åˆå¹¶å¤šä¸ªæ‰«æç»“æœ
cat scan1.xml scan2.xml > combined.xml
```

---

## âš ï¸ æ³¨æ„äº‹é¡¹

### æ³•å¾‹å’Œé“å¾·è€ƒè™‘
1. **è·å¾—æˆæƒ**ï¼šå§‹ç»ˆç¡®ä¿æœ‰æƒé™æ‰«æç›®æ ‡ç½‘ç»œ
2. **éµå®ˆæ³•å¾‹**ï¼šäº†è§£å½“åœ°ç½‘ç»œå®‰å…¨æ³•å¾‹æ³•è§„
3. **è´Ÿè´£ä»»çš„æŠ«éœ²**ï¼šå‘ç°æ¼æ´åæŒ‰ç…§è´Ÿè´£ä»»æŠ«éœ²åŸåˆ™å¤„ç†
4. **æœ€å°å½±å“**ï¼šä½¿ç”¨é€‚å½“çš„æ‰«æå¼ºåº¦ï¼Œé¿å…å½±å“ä¸šåŠ¡

### æŠ€æœ¯æ³¨æ„äº‹é¡¹
1. **é˜²ç«å¢™æ£€æµ‹**ï¼šç°ä»£é˜²ç«å¢™å¯èƒ½æ£€æµ‹åˆ°æ‰«æè¡Œä¸º
2. **æ—¥å¿—è®°å½•**ï¼šæ‰«ææ´»åŠ¨ä¼šè¢«ç›®æ ‡ç³»ç»Ÿè®°å½•
3. **ç½‘ç»œå½±å“**ï¼šå¤§è§„æ¨¡æ‰«æå¯èƒ½å½±å“ç½‘ç»œæ€§èƒ½
4. **è¯¯æŠ¥å¤„ç†**ï¼šéªŒè¯æ‰«æç»“æœï¼Œé¿å…è¯¯æŠ¥

---

ğŸ’¡ **å°è´´å£«**: Nmapæ˜¯ä¸€ä¸ªå¼ºå¤§çš„å·¥å…·ï¼Œä½†å¼ºå¤§æ„å‘³ç€è´£ä»»ã€‚å§‹ç»ˆç¡®ä¿åœ¨æˆæƒèŒƒå›´å†…ä½¿ç”¨ï¼Œå¹¶éµå®ˆç›¸å…³æ³•å¾‹æ³•è§„ã€‚å®šæœŸæ›´æ–°NmapåŠå…¶è„šæœ¬æ•°æ®åº“ä»¥è·å¾—æœ€æ–°çš„æ£€æµ‹èƒ½åŠ›ã€‚